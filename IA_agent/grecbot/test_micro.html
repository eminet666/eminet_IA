let mediaRecorder;
let audioChunks = [];

const startBtn = document.getElementById("startBtn");
const stopBtn = document.getElementById("stopBtn");
const status = document.getElementById("status");
const audio = document.getElementById("audio");

startBtn.addEventListener("click", async () => {
status.textContent = "Demande dâ€™accÃ¨s au microâ€¦";

try {
const stream = await navigator.mediaDevices.getUserMedia({
audio: true
});

mediaRecorder = new MediaRecorder(stream);
audioChunks = [];

mediaRecorder.ondataavailable = (event) => {
audioChunks.push(event.data);
};

mediaRecorder.onstop = () => {
const blob = new Blob(audioChunks, { type: "audio/webm" });
const url = URL.createObjectURL(blob);
audio.src = url;
status.textContent = "âœ… Enregistrement terminÃ©";
};

mediaRecorder.start();
status.textContent = "ðŸŽ™ï¸ Enregistrement en coursâ€¦";

startBtn.disabled = true;
stopBtn.disabled = false;

} catch (err) {
console.error(err);
status.textContent =
"âŒ Erreur micro : " + err.name + " â€“ " + err.message;
}
});

stopBtn.addEventListener("click", () => {
mediaRecorder.stop();

startBtn.disabled = false;
stopBtn.disabled = true;
});